---
import { getRecentIPOs } from '../../data/ipo-data';
import { formatDate } from '../../utils/utils';

const recentIPOs = getRecentIPOs(4);
---

<section class="section bg-alabaster">
  <div class="container">
    <div class="flex items-center justify-between mb-8">
      <div>
        <p class="label text-copper page-kicker">Live Data</p>
        <h2 class="page-title">Saudi IPO Tracker</h2>
      </div>
      <a href="/ipo-tracker" class="hidden sm:inline-flex btn-secondary text-sm py-2 px-4">View Full Tracker</a>
    </div>

    <!-- Stats Row -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
      <div class="card text-center py-5">
        <span class="font-data text-2xl font-bold text-sage block">19</span>
        <span class="text-sm text-gray-500">IPOs Tracked</span>
      </div>
      <div class="card text-center py-5">
        <span class="font-data text-2xl font-bold text-sage block">SAR 158.8B</span>
        <span class="text-sm text-gray-500">Total Market Cap</span>
      </div>
      <div class="card text-center py-5">
        <span class="font-data text-2xl font-bold text-sage block">+38.7%</span>
        <span class="text-sm text-gray-500">Average Return</span>
      </div>
      <div class="card text-center py-5">
        <span class="font-data text-2xl font-bold text-sage block">8</span>
        <span class="text-sm text-gray-500">Sectors Covered</span>
      </div>
    </div>

    <!-- Recent IPO Cards -->
    <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4">
      {recentIPOs.map(ipo => (
        <div class="card">
          <div class="flex items-start justify-between gap-2 mb-3">
            <span class="badge badge-sage normal-case tracking-normal whitespace-normal leading-tight">{ipo.sector}</span>
            <span class={`font-data text-sm font-bold ${ipo.return_from_ipo >= 0 ? 'performance-positive' : 'performance-negative'}`}>
              {ipo.return_from_ipo > 0 ? '+' : ''}{ipo.return_from_ipo}%
            </span>
          </div>
          <h4 class="font-heading text-base font-bold mb-1">{ipo.company_name}</h4>
          <p class="text-xs text-gray-400 font-data mb-3">{ipo.symbol} Â· {formatDate(ipo.listing_date)}</p>
          <div class="flex justify-between items-center text-sm">
            <span class="text-gray-500">IPO Price</span>
            <span class="font-data font-bold">SAR {ipo.offer_price.toFixed(2)}</span>
          </div>
          <div class="flex justify-between items-center text-sm mt-1">
            <span class="text-gray-500">Market Cap</span>
            <span class="font-data font-bold">{ipo.market_cap_display}</span>
          </div>
        </div>
      ))}
    </div>

    <div class="text-center mt-8 sm:hidden">
      <a href="/ipo-tracker" class="btn-primary text-sm py-2 px-6">View Full Tracker</a>
    </div>

    <div class="mt-6 p-4 bg-white border border-gray-200 rounded-lg">
      <p class="text-xs text-gray-600 m-0 leading-relaxed">
        Data shown is an informational snapshot. For full methodology, source details, and latest as-of date, use the full IPO Tracker page.
      </p>
    </div>
  </div>
</section>
